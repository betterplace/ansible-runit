---
- name: Install the runit rpm from a remote repo
  yum:
    name: https://github.com/betterplace/packages/raw/master/runit-2.1.2-1.el7.centos.x86_64.rpm
    state: present

- name: Ensure sv and service directory exists
  file: path=/etc/{{item}} state=directory
  with_items:
    - sv
    - service

- name: Enable the runsvdir-start daemon
  command: "systemctl enable /usr/lib/systemd/system/runsvdir-start.service"

- name: Start the runsvdir-start daemon
  command: "systemctl start runsvdir-start"

- name: Allow betterplace to exec sv
  lineinfile: "
    dest=/etc/sudoers
    state=present
    line='betterplace ALL=(ALL) NOPASSWD: /sbin/sv'
  "
